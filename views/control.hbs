
{{> header}}

<br>

<div class="row" style="display: inline-block; width: 100%">
    <div class="col-10 col-centered" style="float: center">
        <h4 style="text-align: center; color: #7b7b7b; font-size: 50px">Shopping History <i class="fas fa-shopping-cart"></i></h4>
        <br>
        <table class="table" style="color:#7b7b7b">
            <thead>
                <tr style="background-color: #00b8a4; color:white">
                    <th scope="col">Date Purchased</th>
                    <th scope="col">Product</th>
                    <th scope="col">Price</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <th scope="row">12/129/1997</th>
                    <td>tgruseiwqwerdgrggtnrtg4gretrgt4tnt4getng4geg3gregf</td>
                    <td>$20.00</td>
                </tr>
                <tr>
                    <th scope="row">11/22/33</th>
                    <td>This is a piece of placeholder data you dummy</td>
                    <td>$3.50</td>
                </tr>
                <tr>
                    <th scope="row">12/29/97</th>
                    <td>Yeet</td>
                    <td>$40.00</td>
                </tr>
            </tbody>
        </table>
    </div>
    <br>
    <br>
    <hr>
    <br>
    <div class="col-6 col-centered" style="float: center">
        <h4 style="text-align: center; color: #7b7b7b; font-size: 50px">Change Your Password <i class="fas fa-lock"></i></h4>
        <br>
        <div class="form-group">
            <div class="input-group">
                <input id="oldPassword" type="text" class="form-control" placeholder="Old Password" name="oldPassword"/>
            </div>
        </div>
        <div class="form-group">
            <div class="input-group">
                <input id="newPassword1" type="password" class="form-control" placeholder="New Password" name="newPassword1"/>
            </div>
        </div>
        <div class="form-group">
            <div class="input-group">
                <input id="newPassword2" type="password" class="form-control" placeholder="Comfirm Password" name="newPassword2"/>
            </div>
        </div>
        <div>
            <button style="width: -webkit-fill-available;" type="button" id="passwordSubmit" class="btn btn-blue">Change Password</button>
        </div>
    </div>
</div>

<script>
    $(document).ready(function(){
        // Navigate to home page
        $('#home').on("click", function() {
            window.location = '/';
        });

        // Navigate to control page
        $('#user').on("click", function() {
            window.location = '/control';
        });

        $("#passwordSubmit").on("click", function() {
            event.preventDefault();
            alert("yo");
            // TODO password 1 and 2 dont match

            user = {
                oldPassword: $('#oldPassword').val(),
                password: $('#newPassword1').val()
            };

            $.ajax({
                url: 'control/changePassword',
                type: 'PUT',
                contentType: 'application/JSON',
                data: JSON.stringify(user),
                success: function (response) {
                    // TODO success message
                    alert("success");
                    location.reload();
                },
                error: function () {
                    // TODO fail message
                    alert("old password is not correct BRO");
                }
            });
        });
    });
</script>
